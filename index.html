<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>XP-JS by thekid</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/thekid/xp-js">Fork On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/thekid/xp-js/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/thekid/xp-js/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>XP-JS</h1>
          <p>XP on JavaScript</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/thekid">thekid</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></span>
        </div>

        <h1>XP to JS compiler / XP JS microkernel</h1>

<p>This experiment tries to see whether the <a href="http://github.com/xp-framework">XP Framework </a>
could be based on JavaScript runtimes in the future. Paired with the XP compiler, its 
PHP language parser and the generator to emit JavaScript, and maybe together with 
porting some of PHP's string and array functions, we would be able to exchange the 
PHP platform we currently depend on for something else.</p>

<p>See also:</p>

<ul>
<li><a href="http://news.planet-xp.net/article/452/2012/03/21/">http://news.planet-xp.net/article/452/2012/03/21/</a></li>
<li><a href="http://news.planet-xp.net/article/451/2012/03/11/">http://news.planet-xp.net/article/451/2012/03/11/</a></li>
<li><a href="http://news.planet-xp.net/article/449/2012/02/26/">http://news.planet-xp.net/article/449/2012/02/26/</a></li>
</ul><h2>Demo class</h2>

<div class="highlight">
<pre><span class="c1">// {{{ Hello</span>
<span class="nx">Hello</span> <span class="o">=</span> <span class="nx">define</span><span class="p">(</span><span class="s1">'Hello'</span><span class="p">,</span> <span class="s1">'lang.Object'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">Hello</span> <span class="p">()</span> <span class="p">{</span> <span class="p">});</span>

<span class="nx">Hello</span><span class="p">.</span><span class="nx">main</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Hello$main</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">lang</span><span class="p">.</span><span class="nx">IllegalArgumentException</span><span class="p">(</span><span class="s1">'Argument required'</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">util</span><span class="p">.</span><span class="nx">cmd</span><span class="p">.</span><span class="nx">Console</span><span class="p">.</span><span class="nx">writeLine</span><span class="p">(</span><span class="s1">'Hello '</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="p">}</span>
<span class="c1">// }}}</span>

</pre>
</div>


<h2>NodeJS</h2>

<p>Node.JS is the V8-based JavaScript engine which is becoming increasingly
popular. Even with its pre-1.0 status, sites such as GitHub use it in 
production.
See <a href="http://nodejs.org/">http://nodejs.org/</a></p>

<p><strong>Getting started</strong></p>

<div class="highlight">
<pre><span class="nv">$ </span>node tools/node.js Hello <span class="s2">"World"</span>
Hello World
</pre>
</div>


<div class="highlight">
<pre><span class="nv">$ </span>node tools/node.js Hello
*** Uncaught exception lang.IllegalArgumentException<span class="o">(</span>Argument required<span class="o">)</span>
  at IllegalArgumentException<span class="o">(</span><span class="s2">"Argument required"</span><span class="o">)</span> <span class="o">[</span>line 5 of IllegalArgumentException.js<span class="o">]</span>
  at Hello.main<span class="o">(</span>array<span class="o">[</span>0<span class="o">])</span> <span class="o">[</span>line 6 of Hello.js<span class="o">]</span>
  at Method.invoke<span class="o">(</span>null, array<span class="o">[</span>1<span class="o">])</span> <span class="o">[</span>line 26 of Method.js<span class="o">]</span>
  at __main<span class="o">()</span> <span class="o">[</span>line 194 of node.js<span class="o">]</span>
</pre>
</div>


<h2>Setting up the compiler</h2>

<p>You need the branch "node" of my xp-language fork checked out:</p>

<div class="highlight">
<pre><span class="nv">$ </span>git clone -b node git://github.com/thekid/xp-language.git xp.node
Cloning into xp.node...
<span class="o">[</span>...<span class="o">]</span>
</pre>
</div>


<p>Then, you need to add this to the <code>use</code> line in your <strong>xp.ini</strong> file. <em>This
file will usually be in ~/.xp/xp.ini or ~/bin/xp.ini.</em> Add the path to the
"compiler" subdirectory of the "xp.node" directory from above to the end
of this line, prefixed by the platform's path separator character. For 
example, this will work on Un*x platforms (in Windows, use semicolons):</p>

<div class="highlight">
<pre><span class="gd">-use=~/devel/xp/core:~/devel/xp/tools</span>
<span class="gi">+use=~/devel/xp/core:~/devel/xp/tools:~/devel/xp.node/compiler</span>
</pre>
</div>


<p>You're all set to go.</p>

<h2>Compiling</h2>

<p>To compile classes from XP language to XP JS, simply invoke the <strong>xcc</strong> 
command as follows:</p>

<div class="highlight">
<pre><span class="nv">$ </span>xcc -e node Hello.xp
<span class="o">[</span>.<span class="o">]</span>
Done: 1/1 compiled, 0 failed
</pre>
</div>


<p>Then, run it as seen above.</p>

<h2>Class path</h2>

<p>For a start just put all the classes in the current directory. Later on,
when you want to start sorting stuff out, you can place compiled classes 
anywhere in the class path. The class path is compiled from the paths 
listed in the <code>.pth</code> files (as with the XP Framework). To get an overview 
of all currently registered class paths, execute the entry point without 
arguments:</p>

<div class="highlight">
<pre><span class="nv">$ </span>node tools/node.js
XP JS Microkernel 0.9.1 <span class="o">{</span> Node 0.6.14 &amp; V8 3.6.6.24 <span class="o">}</span> @ Windows_NT 6.1.7600 <span class="o">(</span>ia32<span class="o">)</span>
Copyright <span class="o">(</span>c<span class="o">)</span> 2011-2012 the XP group
lang.FileSystemClassLoader&lt;C:<span class="se">\c</span>ygwin<span class="se">\h</span>ome<span class="se">\f</span>riebe<span class="se">\d</span>evel<span class="se">\x</span>p-js<span class="se">\c</span>ore<span class="se">\s</span>rc<span class="se">\m</span>ain<span class="se">\j</span>s&gt;
lang.FileSystemClassLoader&lt;C:<span class="se">\c</span>ygwin<span class="se">\h</span>ome<span class="se">\f</span>riebe<span class="se">\d</span>evel<span class="se">\x</span>p-js<span class="se">\t</span>est<span class="se">\s</span>rc<span class="se">\m</span>ain<span class="se">\j</span>s&gt;
lang.archive.ArchiveClassLoader&lt;C:<span class="se">\c</span>ygwin<span class="se">\h</span>ome<span class="se">\f</span>riebe<span class="se">\d</span>evel<span class="se">\x</span>p-js<span class="se">\l</span>ib<span class="se">\t</span>ools.xar&gt;
lang.FileSystemClassLoader&lt;C:<span class="se">\c</span>ygwin<span class="se">\h</span>ome<span class="se">\f</span>riebe<span class="se">\d</span>evel<span class="se">\x</span>p-js&gt;
</pre>
</div>


<h2>Testing</h2>

<p>The classes provided in the microkernel are tested by unittests in the
directory with the same name. To run these tests, invoke the following
command:</p>

<div class="highlight">
<pre><span class="nv">$ </span>node tools/node.js Unittest unittests.*
<span class="o">[</span>........................................................................
.......................................<span class="o">]</span>

OK: 111 run, 111 succeeded, 0 failed
Memory used: 12728 kB
Time taken: 0.016 sec<span class="o">(</span>s<span class="o">)</span>
</pre>
</div>


<p>The tests are written in XP language. Any changes made to the <code>*.xp</code>
files need to be recompiled to JavaScript before executing. This can be 
accomplished by running <code>xcc -e node unittests/*.xp</code>.</p>

<h2>Contributing</h2>

<p>If you would like to contribute, you can do it the GitHub way by opening
issues or pull requests. To see where help is needed, check the 
<a href="https://github.com/thekid/xp-js/blob/master/docs/status.md">implementation status document</a></p>

<hr><p><strong>Happy hacking!</strong></p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
    
  </body>
</html>